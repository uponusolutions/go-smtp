<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# client

```go
import "github.com/uponusolutions/go-smtp/client"
```

## Index

- [type Client](<#Client>)
  - [func New\(opts ...Option\) \*Client](<#New>)
  - [func \(c \*Client\) Auth\(a sasl.Client\) error](<#Client.Auth>)
  - [func \(c \*Client\) Close\(\) error](<#Client.Close>)
  - [func \(c \*Client\) Connect\(ctx context.Context\) error](<#Client.Connect>)
  - [func \(c \*Client\) Data\(\) \(\*DataCloser, error\)](<#Client.Data>)
  - [func \(c \*Client\) Extension\(ext string\) \(bool, string\)](<#Client.Extension>)
  - [func \(c \*Client\) Mail\(from string, opts \*MailOptions\) error](<#Client.Mail>)
  - [func \(c \*Client\) MaxMessageSize\(\) \(size int, ok bool\)](<#Client.MaxMessageSize>)
  - [func \(c \*Client\) Noop\(\) error](<#Client.Noop>)
  - [func \(c \*Client\) Quit\(\) error](<#Client.Quit>)
  - [func \(c \*Client\) Rcpt\(to string, opts \*smtp.RcptOptions\) error](<#Client.Rcpt>)
  - [func \(c \*Client\) Reset\(\) error](<#Client.Reset>)
  - [func \(c \*Client\) Send\(from string, rcpt \[\]string, msg \[\]byte\) error](<#Client.Send>)
  - [func \(c \*Client\) SendMail\(from string, rcpt \[\]string, in io.Reader\) \(code int, msg string, err error\)](<#Client.SendMail>)
  - [func \(c \*Client\) ServerAddress\(\) string](<#Client.ServerAddress>)
  - [func \(c \*Client\) ServerAddresses\(\) \[\]\[\]string](<#Client.ServerAddresses>)
  - [func \(c \*Client\) ServerName\(\) string](<#Client.ServerName>)
  - [func \(c \*Client\) SetXOORG\(xoorg \*string\)](<#Client.SetXOORG>)
  - [func \(c \*Client\) SupportsAuth\(mech string\) bool](<#Client.SupportsAuth>)
  - [func \(c \*Client\) TLSConnectionState\(\) \(tls.ConnectionState, bool\)](<#Client.TLSConnectionState>)
  - [func \(c \*Client\) Verify\(addr string, opts \*VrfyOptions\) error](<#Client.Verify>)
- [type DataCloser](<#DataCloser>)
  - [func \(d \*DataCloser\) Close\(\) error](<#DataCloser.Close>)
  - [func \(d \*DataCloser\) CloseWithResponse\(\) \(code int, msg string, err error\)](<#DataCloser.CloseWithResponse>)
- [type MailOptions](<#MailOptions>)
- [type Option](<#Option>)
  - [func WithCommandTimeout\(commandTimeout time.Duration\) Option](<#WithCommandTimeout>)
  - [func WithDialTimeout\(dialTimeout time.Duration\) Option](<#WithDialTimeout>)
  - [func WithLocalName\(localName string\) Option](<#WithLocalName>)
  - [func WithMailOptions\(mailOptions MailOptions\) Option](<#WithMailOptions>)
  - [func WithMaxLineLength\(maxLineLength int\) Option](<#WithMaxLineLength>)
  - [func WithReaderSize\(readerSize int\) Option](<#WithReaderSize>)
  - [func WithSASLClient\(cl sasl.Client\) Option](<#WithSASLClient>)
  - [func WithSecurity\(security Security\) Option](<#WithSecurity>)
  - [func WithServerAddressIndex\(index int\) Option](<#WithServerAddressIndex>)
  - [func WithServerAddresses\(addrs ...string\) Option](<#WithServerAddresses>)
  - [func WithServerAddressesPrio\(addrs ...\[\]string\) Option](<#WithServerAddressesPrio>)
  - [func WithSubmissionTimeout\(submissionTimeout time.Duration\) Option](<#WithSubmissionTimeout>)
  - [func WithTLSConfig\(cfg \*tls.Config\) Option](<#WithTLSConfig>)
  - [func WithTlsHandshakeTimeout\(tlsHandshakeTimeout time.Duration\) Option](<#WithTlsHandshakeTimeout>)
  - [func WithWriterSize\(writerSize int\) Option](<#WithWriterSize>)
- [type Security](<#Security>)
- [type UTF8](<#UTF8>)
- [type VrfyOptions](<#VrfyOptions>)


<a name="Client"></a>
## type Client

Client is an SMTP client. It sends one or more mails to a SMTP server over a single connection. TODO: Add context support.

```go
type Client struct {
    // contains filtered or unexported fields
}
```

<a name="New"></a>
### func New

```go
func New(opts ...Option) *Client
```

New returns a new SMTP client. When not set via options the address 127.0.0.1:25 is used. When not set via options a default tls.Config is used.

<a name="Client.Auth"></a>
### func \(\*Client\) Auth

```go
func (c *Client) Auth(a sasl.Client) error
```

Auth authenticates a client using the provided authentication mechanism. Only servers that advertise the AUTH extension support this function.

If server returns an error, it will be of type \*smtp.

<a name="Client.Close"></a>
### func \(\*Client\) Close

```go
func (c *Client) Close() error
```

Close closes the connection.

<a name="Client.Connect"></a>
### func \(\*Client\) Connect

```go
func (c *Client) Connect(ctx context.Context) error
```

Connect connects to one of the available SMTP server. When server supports auth and clients SaslClient is set, auth is called. Security is enforced like configured \(Plain, TLS, StartTLS or PreferStartTLS\) If an error occures, the connection is closed if open.

<a name="Client.Data"></a>
### func \(\*Client\) Data

```go
func (c *Client) Data() (*DataCloser, error)
```

Data issues a DATA command to the server and returns a writer that can be used to write the mail headers and body. The caller should close the writer before calling any more methods on c. A call to Data must be preceded by one or more calls to Rcpt.

If server returns an error, it will be of type \*smtp.

<a name="Client.Extension"></a>
### func \(\*Client\) Extension

```go
func (c *Client) Extension(ext string) (bool, string)
```

Extension reports whether an extension is support by the server. The extension name is case\-insensitive. If the extension is supported, Extension also returns a string that contains any parameters the server specifies for the extension.

<a name="Client.Mail"></a>
### func \(\*Client\) Mail

```go
func (c *Client) Mail(from string, opts *MailOptions) error
```

Mail issues a MAIL command to the server using the provided email address. If the server supports the 8BITMIME extension, Mail adds the BODY=8BITMIME parameter. This initiates a mail transaction and is followed by one or more Rcpt calls.

If opts is not nil, MAIL arguments provided in the structure will be added to the command. Handling of unsupported options depends on the extension.

If server returns an error, it will be of type \*smtp.

<a name="Client.MaxMessageSize"></a>
### func \(\*Client\) MaxMessageSize

```go
func (c *Client) MaxMessageSize() (size int, ok bool)
```

MaxMessageSize returns the maximum message size accepted by the server. 0 means unlimited.

If the server doesn't convey this information, ok = false is returned.

<a name="Client.Noop"></a>
### func \(\*Client\) Noop

```go
func (c *Client) Noop() error
```

Noop sends the NOOP command to the server. It does nothing but check that the connection to the server is okay.

<a name="Client.Quit"></a>
### func \(\*Client\) Quit

```go
func (c *Client) Quit() error
```

Quit sends the QUIT command and closes the connection to the server. If Quit fails the connection will still be closed.

<a name="Client.Rcpt"></a>
### func \(\*Client\) Rcpt

```go
func (c *Client) Rcpt(to string, opts *smtp.RcptOptions) error
```

Rcpt issues a RCPT command to the server using the provided email address. A call to Rcpt must be preceded by a call to Mail and may be followed by a Data call or another Rcpt call.

If opts is not nil, RCPT arguments provided in the structure will be added to the command. Handling of unsupported options depends on the extension.

If server returns an error, it will be of type \*smtp.

<a name="Client.Reset"></a>
### func \(\*Client\) Reset

```go
func (c *Client) Reset() error
```

Reset sends the RSET command to the server, aborting the current mail transaction.

<a name="Client.Send"></a>
### func \(\*Client\) Send

```go
func (c *Client) Send(from string, rcpt []string, msg []byte) error
```

Send implements enmime.Sender interface.

<a name="Client.SendMail"></a>
### func \(\*Client\) SendMail

```go
func (c *Client) SendMail(from string, rcpt []string, in io.Reader) (code int, msg string, err error)
```

SendMail will use an existing connection to send an email from address from, to addresses to, with message r.

This function does not start TLS, nor does it perform authentication. Use DialStartTLS and Auth before\-hand if desirable.

The addresses in the to parameter are the SMTP RCPT addresses.

The r parameter should be an RFC 822\-style email with headers first, a blank line, and then the message body. The lines of r should be CRLF terminated. The r headers should usually include fields such as "From", "To", "Subject", and "Cc". Sending "Bcc" messages is accomplished by including an email address in the to parameter but not including it in the r headers.

<a name="Client.ServerAddress"></a>
### func \(\*Client\) ServerAddress

```go
func (c *Client) ServerAddress() string
```

ServerAddress returns the current server address.

<a name="Client.ServerAddresses"></a>
### func \(\*Client\) ServerAddresses

```go
func (c *Client) ServerAddresses() [][]string
```

ServerAddresses returns the server address.

<a name="Client.ServerName"></a>
### func \(\*Client\) ServerName

```go
func (c *Client) ServerName() string
```

ServerName returns the current server name.

<a name="Client.SetXOORG"></a>
### func \(\*Client\) SetXOORG

```go
func (c *Client) SetXOORG(xoorg *string)
```

SetXOORG set xoorg support

<a name="Client.SupportsAuth"></a>
### func \(\*Client\) SupportsAuth

```go
func (c *Client) SupportsAuth(mech string) bool
```

SupportsAuth checks whether an authentication mechanism is supported.

<a name="Client.TLSConnectionState"></a>
### func \(\*Client\) TLSConnectionState

```go
func (c *Client) TLSConnectionState() (tls.ConnectionState, bool)
```

TLSConnectionState returns the client's TLS connection state. The return values are their zero values if STARTTLS did not succeed.

<a name="Client.Verify"></a>
### func \(\*Client\) Verify

```go
func (c *Client) Verify(addr string, opts *VrfyOptions) error
```

Verify checks the validity of an email address on the server. If Verify returns nil, the address is valid. A non\-nil return does not necessarily indicate an invalid address. Many servers will not verify addresses for security reasons.

If server returns an error, it will be of type \*smtp.

<a name="DataCloser"></a>
## type DataCloser

DataCloser implement an io.WriteCloser with the additional CloseWithResponse function.

```go
type DataCloser struct {
    io.WriteCloser
    // contains filtered or unexported fields
}
```

<a name="DataCloser.Close"></a>
### func \(\*DataCloser\) Close

```go
func (d *DataCloser) Close() error
```

Close closes the data closer.

<a name="DataCloser.CloseWithResponse"></a>
### func \(\*DataCloser\) CloseWithResponse

```go
func (d *DataCloser) CloseWithResponse() (code int, msg string, err error)
```

CloseWithResponse closes the data closer and returns code, msg

<a name="MailOptions"></a>
## type MailOptions

MailOptions contains parameters for the MAIL command.

```go
type MailOptions struct {
    // Size of the body. Can be 0 if not specified by client.
    Size int64

    // TLS is required for the message transmission.
    //
    // The message should be rejected if it can't be transmitted
    // with TLS.
    RequireTLS bool

    // The message envelope or message header contains UTF-8-encoded strings.
    // This flag is set by SMTPUTF8-aware (RFC 6531) client.
    UTF8 UTF8

    // Value of RET= argument, FULL or HDRS.
    Return smtp.DSNReturn

    // Envelope identifier set by the client.
    EnvelopeID string

    // Accepted Domain from Exchange Online, e.g. from OutgoingConnector
    XOORG *string

    // The authorization identity asserted by the message sender in decoded
    // form with angle brackets stripped.
    //
    // nil value indicates missing AUTH, non-nil empty string indicates
    // AUTH=<>.
    //
    // Defined in RFC 4954.
    Auth *string
}
```

<a name="Option"></a>
## type Option

Option defines a client option.

```go
type Option func(c *Client)
```

<a name="WithCommandTimeout"></a>
### func WithCommandTimeout

```go
func WithCommandTimeout(commandTimeout time.Duration) Option
```

WithCommandTimeout sets the command timeout.

<a name="WithDialTimeout"></a>
### func WithDialTimeout

```go
func WithDialTimeout(dialTimeout time.Duration) Option
```

WithDialTimeout sets the dial timeout.

<a name="WithLocalName"></a>
### func WithLocalName

```go
func WithLocalName(localName string) Option
```

WithLocalName sets the HELO local name.

<a name="WithMailOptions"></a>
### func WithMailOptions

```go
func WithMailOptions(mailOptions MailOptions) Option
```

WithMailOptions sets the mail options.

<a name="WithMaxLineLength"></a>
### func WithMaxLineLength

```go
func WithMaxLineLength(maxLineLength int) Option
```

WithMaxLineLength sets the max line length.

<a name="WithReaderSize"></a>
### func WithReaderSize

```go
func WithReaderSize(readerSize int) Option
```

WithReaderSize sets the reader size.

<a name="WithSASLClient"></a>
### func WithSASLClient

```go
func WithSASLClient(cl sasl.Client) Option
```

WithSASLClient sets the SASL client.

<a name="WithSecurity"></a>
### func WithSecurity

```go
func WithSecurity(security Security) Option
```

WithSecurity sets the TLS config.

<a name="WithServerAddressIndex"></a>
### func WithServerAddressIndex

```go
func WithServerAddressIndex(index int) Option
```

WithServerAddressIndex sets the SMTP server index.

<a name="WithServerAddresses"></a>
### func WithServerAddresses

```go
func WithServerAddresses(addrs ...string) Option
```

WithServerAddresses sets the SMTP servers address.

<a name="WithServerAddressesPrio"></a>
### func WithServerAddressesPrio

```go
func WithServerAddressesPrio(addrs ...[]string) Option
```

WithServerAddressesPrio sets the SMTP servers address.

<a name="WithSubmissionTimeout"></a>
### func WithSubmissionTimeout

```go
func WithSubmissionTimeout(submissionTimeout time.Duration) Option
```

WithSubmissionTimeout sets the submission timeout.

<a name="WithTLSConfig"></a>
### func WithTLSConfig

```go
func WithTLSConfig(cfg *tls.Config) Option
```

WithTLSConfig sets the TLS config.

<a name="WithTlsHandshakeTimeout"></a>
### func WithTlsHandshakeTimeout

```go
func WithTlsHandshakeTimeout(tlsHandshakeTimeout time.Duration) Option
```

WithTlsHandshakeTimeout sets tls handshake timeout.

<a name="WithWriterSize"></a>
### func WithWriterSize

```go
func WithWriterSize(writerSize int) Option
```

WithWriterSize sets the reader size.

<a name="Security"></a>
## type Security

Security describes how the connection is etablished.

```go
type Security int32
```

<a name="SecurityPreferStartTLS"></a>

```go
const (
    // SecurityPreferStartTLS tries to use StartTls but fallbacks to plain.
    SecurityPreferStartTLS Security = 0
    // SecurityPlain is always just a plain connection.
    SecurityPlain Security = 1
    // SecurityTLS does a implicit tls connection.
    SecurityTLS Security = 2
    // SecurityStartTLS always does starttls.
    SecurityStartTLS Security = 3
)
```

<a name="UTF8"></a>
## type UTF8

UTF8 describes how SMTPUTF8 is used.

```go
type UTF8 int32
```

<a name="UTF8Prefer"></a>

```go
const (
    // UTF8Prefer uses SMTPUTF8 if possible.
    UTF8Prefer UTF8 = 0
    // UTF8Force always uses SMTPUTF8.
    UTF8Force UTF8 = 1
    // UTF8Disabled never uses SMTPUTF8.
    UTF8Disabled UTF8 = 2
)
```

<a name="VrfyOptions"></a>
## type VrfyOptions

VrfyOptions contains parameters for the VRFY command.

```go
type VrfyOptions struct {
    // The message envelope or message header contains UTF-8-encoded strings.
    // This flag is set by SMTPUTF8-aware (RFC 6531) client.
    UTF8 UTF8
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->